(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{141:function(e,t,n){e.exports=n(255)},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},247:function(e,t,n){},254:function(e,t,n){},255:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(55),c=n.n(l),i=(n(146),n(29)),o=n(50),s=n(13),u=n(15),m=n(14),d=n(16),h="".concat("/item_indexer/spa","/../api/"),p=function(e){return h+e+".json"},f=(n(147),function(e){return""+parseInt(e)===e}),b=function(){return r.a.createElement("div",{className:"preview-instructions"},"Loading...")},g=function(){return r.a.createElement("div",{className:"preview-instructions"},"Enter a bridge catalog db product id to preview how it is indexed.")},v=function(e){return r.a.createElement("pre",{className:"align-left preview"},JSON.stringify(e.content,null," "))},E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).onChange=function(e){var t=e.target.value;n.setState({productId:t,canSubmit:f(t)})},n.onTypeChange=function(e){var t=e.target.value;n.setState({type:t})},n.getUrl=function(){var e="product"===n.state.type?"products":"sku_sales_summary";return"".concat(e,"/").concat(n.state.productId,".json?stream=false")},n.getPlaceholder=function(){return"product"===n.state.type?"product id":"sku sales summary sales id"},n.preview=function(e){n.setState({isLoading:!0}),fetch(p(n.getUrl())).then(function(e){return e.json()}).then(function(e){return n.setState({preview:e})}).catch(function(e){return alert("Unable to preview: ".concat(e))}).finally(function(){n.setState({isLoading:!1})}),e.preventDefault()},n.body=function(){var e=n.state,t=e.isLoading,a=e.preview;return t?r.a.createElement(b,null):a?r.a.createElement(v,{content:a}):r.a.createElement(g,null)},n.render=function(){var e=n.state,t=e.productId,a=e.canSubmit;return r.a.createElement("form",{onSubmit:n.preview},r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"type",value:"product",checked:"product"===n.state.type,onChange:n.onTypeChange}),"Product"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"type",value:"skuDailySales",checked:"skuDailySales"===n.state.type,onChange:n.onTypeChange}),"SKU Sales"),r.a.createElement("input",{value:t,onChange:n.onChange,autoFocus:!0,placeholder:n.getPlaceholder(),className:"preview-text-input"}),r.a.createElement("span",null,a),r.a.createElement("button",{className:"preview-button",disabled:!a},"Preview"),n.body())},n.state={productId:"",canSubmit:!1,preview:"",isLoading:!1,type:"product"},n}return Object(d.a)(t,e),t}(a.Component);var k=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Welcome to Item Indexer"),r.a.createElement(E,null))},y=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Product Preview"),r.a.createElement(E,null))},j=n(33),w=n(19),O=n(140),_=function(e){return e&&"".concat(e,"px")},S=function(e){var t=function(e){var t=0;return e.map(function(e){var n=t;return t+=e,n})}(e.columnWidths);return r.a.createElement("div",{className:"Header",style:{height:_(e.rowHeight),position:"relative",width:_(e.width),border:"0 none"}},e.columnNames.map(function(n,a){return r.a.createElement("div",{key:n,style:{position:"absolute",left:_(t[a]),top:"0px",height:_(e.rowHeight),width:_(e.columnWidths[a])}},n)}))},x=function(e){var t=e.count,n=e.singular,a=e.plural;return r.a.createElement("span",null,function(){var e=n;return 1!==t&&(e=a||n+function(e){return 1===e?"":"s"}()),e}())},C=function(e){var t=e.count,n=e.itemName,a=e.pluralItemName,l=e.isSelected,c=e.onDeselect;return r.a.createElement("div",null,t,"none"!==t&&r.a.createElement("span",null," ",r.a.createElement(x,{count:t,singular:n,plural:a}),l&&r.a.createElement(function(e){var t=e.onDeselect;return r.a.createElement("span",null," selected ",r.a.createElement("span",{className:"clickable link",onClick:t},"clear"))},{onDeselect:c})))},N=(n(148),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).extractData=function(e){if(!e.error)return(n.props.setData||function(e){return e})(e);alert("cannot load data: "+e.error)},n.onDeselect=function(){n.setState(function(e){return{data:e.unfilteredData,unfilteredData:null,selected:null}})},n.state={data:null,unfilteredData:null,selected:null},n.gridRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.data?this.setState({data:this.props.data}):this.props.url&&fetch(this.props.url).then(function(e){return e.json()}).then(function(t){return e.extractData(t)}).then(function(t){return e.setState({data:t})})}},{key:"onClick",value:function(e){var t=this,n=e.target,a=this.props,r=a.onSelectItem,l=a.onClickItem,c=function(){var e=n.getAttribute("data-id");return t.state.data&&t.state.data[e]};if(l&&l(c()),r){var i=c();this.state.selected?this.onDeselect():i&&(this.state.selected||(this.gridRef.current.scrollToItem({align:"start",rowIndex:0}),this.setState(function(e){return{data:[i],unfilteredData:e.unfilteredData||e.data,selected:i}}))),r(i)}}},{key:"count",value:function(){var e="none";return this.state.data&&this.state.data.length&&(e=this.state.data.length),e}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,l=t.height,c=t.rowHeight,i=t.columnNames,o=t.columnWidths,s=t.itemName,u=t.pluralItemName,m=t.itemRenderer,d=Object(a.forwardRef)(function(t,n){return r.a.createElement("div",Object.assign({ref:n,onClick:e.onClick.bind(e)},t))});return r.a.createElement("div",null,this.state.data&&this.state.data.length>0&&r.a.createElement("div",null,r.a.createElement(S,{columnWidths:o,width:n,rowHeight:c,columnNames:i}),r.a.createElement(O.a,{itemData:this.state.data,className:"List",columnCount:o.length,columnWidth:function(e){return o[e]},outerElementType:d,height:this.state.selected?c:l,rowCount:this.state.data.length,rowHeight:function(){return c},width:n,ref:this.gridRef},m)),r.a.createElement(C,{count:this.count(),itemName:s,pluralItemName:u,isSelected:!!this.state.selected,onDeselect:this.onDeselect}))}}]),t}(a.Component)),I=function(e){var t=e.columnIndex,n=e.data,a=e.rowIndex,l=e.style,c=e.columns,i=e.formatters,o=e.classNames,s=n[a][c[t]],u=i[t],m=u?u(s,a):s,d="".concat(o[t]," ").concat(a%2===0?"even":"odd");return r.a.createElement("div",{className:d,"data-id":a,style:l,title:m},m)},D=(n(63),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["id","transform_batch_id","status","status_reason","start_datetime","stop_datetime"],formatters:[function(e,t){return t+1},null,null,null,function(e){return e&&new Date(e).toLocaleString()},function(e){return e&&new Date(e).toLocaleString()}],classNames:["clickable","clickable link","clickable","clickable long","clickable"]},this.props))}}]),t}(a.PureComponent)),T=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["transform_batch_error_id","transform_batch_id","source_item_type","source_item_id","message"],formatters:new Array(5),classNames:[null,null,null,null,"long"]},this.props))}}]),t}(a.PureComponent),R=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).onSelectItem=function(e){var t=e&&e.transform_batch_id,a=n.state.selected===t;n.setState({selected:null}),a||setTimeout(function(){return n.setState({selected:t})},200)},n.state={selected:null},n}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Inbound Transform Batches"),r.a.createElement(N,{width:1350,height:400,rowHeight:35,columnWidths:[50,100,100,500,300,300],columnNames:["#","id","status","reason","start","stop"],itemName:"transform batch",pluralItemName:"transform batches",itemRenderer:D,url:p("transform_batches"),onSelectItem:this.onSelectItem}),this.state.selected&&r.a.createElement("div",{className:"errors-grid"},"Errors",r.a.createElement(N,{width:1350,height:400,rowHeight:35,columnWidths:[100,100,300,150,650],columnNames:["id","batch id","source item type","source item id","message"],itemName:"error",itemRenderer:T,url:p("transform_batches/".concat(this.state.selected)),setData:function(e){return e.batch_errors}})))}}]),t}(a.Component),L=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["id","direct_batch_id","transform_batch_id","class_name","criteria_type","criteria","count"],formatters:[function(e,t){return t+1},null,null,null,null,null,function(e){return e.toLocaleString?e.toLocaleString():e}],classNames:[null,null,null,"long",null,"long",null]},this.props))}}]),t}(a.PureComponent),W=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Direct Batches"),r.a.createElement(N,{width:1600,height:400,rowHeight:35,columnWidths:[50,75,150,275,100,825,125],columnNames:["#","id","transform batch id","class name","criteria type","criteria","count"],itemName:"direct batch",pluralItemName:"direct batches",itemRenderer:L,url:p("direct_batches")}))}}]),t}(a.Component),P=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["id","inbound_batch_id","source","data_type","status","status_reason","file_name","start_datetime","stop_datetime","transform_batch_id"],formatters:[function(e,t){return t+1},null,null,null,null,null,null,function(e){return e&&new Date(e).toLocaleString()},function(e){return e&&new Date(e).toLocaleString()},null],classNames:[null,null,null,null,null,"long","medium",null,null,null,null]},this.props))}}]),t}(a.PureComponent),H=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Inbound Batches"),r.a.createElement(N,{width:1600,height:400,rowHeight:35,columnWidths:[50,75,100,100,75,375,300,200,200,100],columnNames:["#","id","source","data type","status","reason","file_name","start","stop","transform batch id"],itemName:"inbound batch",pluralItemName:"inbound batches",itemRenderer:P,url:p("inbound_batches"),onSelectItem:this.onSelectItem}))}}]),t}(a.Component),A=n(21),B=n(31),M=function(e,t,n){var a=n||"".concat(t,"s");return 1===e?t:a},U=function(e){var t=Math.floor(e/60),n=Math.round(e%60);return"".concat(t," ").concat(M(t,"hour")," ").concat(n," ").concat(M(e,"minute"))},V=(n(247),{error:{chart:{error:{normal:{stroke:"#c0392b",strokeWidth:1}}},axis:{label:{fill:"#c0392b","font-weight":"bold","font-size":"12px"}}},elapsed:{chart:{elapsed:{normal:{stroke:"#2980b9",strokeWidth:1}}},scatterChart:{elapsed:{normal:{stroke:"#2980b9",strokeWidth:1,fill:"#2980b9"}}},axis:{label:{fill:"#2980b9","font-weight":"bold","font-size":"12px"}}}}),z=function(){return r.a.createElement("g",null)},J="",Y=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleTimeRangeChange=function(e){n.setState({timerange:e})},n.handleTrackerChanged=function(e){if(e){var t=n.state.series.atTime(e),a=new Date(t.begin().getTime()+(t.end().getTime()-t.begin().getTime())/2),r=t.get("error"),l="".concat(r," ").concat(M(r,"error")),c=t.get("elapsed"),i={errors:l,elapsed:"".concat(U(c))},o=a.toLocaleDateString();n.setState({tracker:a,trackerValue:i,trackerEvent:t,title:o})}else n.setState({tracker:null,trackerValue:null,trackerEvent:null,title:J})},n.renderMarker=function(e,t,a){return n.state.tracker?r.a.createElement(B.EventMarker,{type:"point",axis:e,event:n.state.trackerEvent,column:t,markerLabel:n.state.trackerValue[e],markerLabelAlign:"right",markerLabelStyle:{fill:"black",stroke:"black",strokeWidth:.25,fontSize:"9px",fontWeight:"normal"},markerRadius:3,markerStyle:{fill:a}}):r.a.createElement(z,null)};var a=n.prepareTimeSeries(e.batches);return n.state={series:a,timerange:a.timerange(),tracker:null,trackerValue:"initial tracker value",trackerEvent:null,title:J},n}return Object(d.a)(t,e),Object(w.a)(t,[{key:"prepareTimeSeries",value:function(e){if(e){var t={name:"Indexing Runs",columns:["time","elapsed","error"],points:e.filter(function(e){return"in progress"!==e.status}).map(function(e){return[new Date(e.start_datetime).getTime(),e.elapsed_seconds/60,e.error_count]}).reverse()};return new A.TimeSeries(t)}}},{key:"renderChart",value:function(){var e=this.state,t=e.series,n=e.timerange,a={error:t.max("error"),elapsed:t.max("elapsed")};return r.a.createElement(B.ChartContainer,{timeRange:n,enablePanZoom:!0,onTimeRangeChanged:this.handleTimeRangeChange,onTrackerChanged:this.handleTrackerChanged,title:this.state.title,titleStyle:{fill:"black"}},r.a.createElement(B.ChartRow,{height:"200"},r.a.createElement(B.YAxis,{id:"errors",label:"Errors (items failed)",max:a.error,style:V.error.axis}),r.a.createElement(B.Charts,null,r.a.createElement(B.LineChart,{axis:"elapsed",series:t,columns:["elapsed"],style:V.elapsed.chart}),r.a.createElement(B.ScatterChart,{axis:"elapsed",series:t,columns:["elapsed"],style:V.elapsed.scatterChart}),r.a.createElement(B.LineChart,{axis:"errors",series:t,columns:["error"],style:V.error.chart}),r.a.createElement(B.ScatterChart,{axis:"errors",series:t,columns:["error"],style:V.error.chart}),this.renderMarker("errors","error","#c0392b"),this.renderMarker("elapsed","elapsed","#2980b9")),r.a.createElement(B.YAxis,{id:"elapsed",label:"Duration (minutes)",max:a.elapsed,style:V.elapsed.axis})))}},{key:"render",value:function(){return r.a.createElement("div",{className:"index-batch-chart-container"},this.renderChart())}}]),t}(a.Component),F=function(e){var t=e.isActive,n=e.onClick,a=e.inert,l=void 0===a?"Refresh":a,c=e.active,i=void 0===c?"Loading":c;return t?r.a.createElement("div",null,i,"..."):r.a.createElement("div",{className:"clickable link",onClick:n},l)},K=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["id","index_batch_id","status","error_count","status_reason","start_datetime","stop_datetime","elapsed"],formatters:[function(e,t){return t+1},null,null,function(e){return e||"?"},null,function(e){return e&&new Date(e).toLocaleString()},function(e){return e&&new Date(e).toLocaleString()},null],classNames:["clickable","clickable","clickable","clickable link","clickable long","clickable","clickable","clickable"]},this.props))}}]),t}(a.PureComponent),Z=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return I(Object(j.a)({columns:["index_batch_error_id","index_batch_id","indexed_item_type","indexed_item_id","message"],formatters:new Array(5),classNames:[null,null,null,"link","long"]},this.props))}}]),t}(a.PureComponent),$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).onSelectItem=function(e){var t=e&&e.index_batch_id,a=n.state.selected===t;n.setState({selected:null}),a||setTimeout(function(){return n.setState({selected:t})},200)},n.onClickErrorItem=function(e){var t=e.indexed_item_type,n=e.indexed_item_id;if("CatModels::Product"===t&&n){var a="/item_indexer/products/".concat(n);window.open(a,"_blank")}else alert("Sorry, not sure how to preview ".concat(t," with id ").concat(n))},n.fetchData=function(){n.setState({loading:!0,indexBatches:null}),fetch(p("index_batches")).then(function(e){return e.json()}).then(function(e){e.error?alert("cannot load data: "+e.error):n.setState({indexBatches:e})}).finally(function(){return n.setState({loading:!1})})},n.state={selected:null,indexBatches:null,loading:!1},n}return Object(d.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.state,t=e.indexBatches,n=e.selected,a=e.loading;return r.a.createElement("div",null,r.a.createElement("h2",null,"Indexing Batches"),t&&r.a.createElement(Y,{batches:t}),t&&r.a.createElement(N,{width:1350,height:400,rowHeight:35,columnWidths:[50,100,100,50,450,225,225,150],columnNames:["#","id","status","errors","reason","start","stop","duration"],itemName:"indexing batch",pluralItemName:"indexing batches",itemRenderer:K,data:t,onSelectItem:this.onSelectItem}),n&&r.a.createElement("div",{className:"errors-grid"},"Errors",r.a.createElement(N,{width:1350,height:400,rowHeight:35,columnWidths:[100,100,200,150,800],columnNames:["id","batch id","source item type","source item id","message"],itemName:"error",itemRenderer:Z,url:p("index_batches/".concat(n)),setData:function(e){return e.batch_errors},onClickItem:this.onClickErrorItem})),r.a.createElement(F,{isActive:a,onClick:this.fetchData}))}}]),t}(a.Component);function q(e){var t=e.match;return r.a.createElement("div",null,r.a.createElement("h3",null,t.params.topicId))}var G=function(e){var t=e.match;return r.a.createElement("div",null,r.a.createElement("h2",null,"Topics"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(i.b,{to:"".concat(t.url,"/rendering")},"Rendering with React")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"".concat(t.url,"/components")},"Components")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"".concat(t.url,"/props-v-state")},"Props v. State"))),r.a.createElement(o.a,{path:"".concat(t.path,"/:topicId"),component:q}),r.a.createElement(o.a,{exact:!0,path:t.path,render:function(){return r.a.createElement("h3",null,"Please select a topic.")}}))};n(254);var Q=function(){return r.a.createElement(i.a,{basename:"".concat("/item_indexer/spa","/")},r.a.createElement("div",{className:"App"},r.a.createElement("ul",{className:"App-navigation"},r.a.createElement("li",null,r.a.createElement(i.b,{to:"/preview"},"Preview")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/direct"},"Direct")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/inbound"},"Inbound")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/transform"},"Transform")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/indexing"},"Indexing"))),r.a.createElement("hr",null),r.a.createElement(o.a,{exact:!0,path:"/",component:k}),r.a.createElement(o.a,{path:"/preview",component:y}),r.a.createElement(o.a,{path:"/direct",component:W}),r.a.createElement(o.a,{path:"/inbound",component:H}),r.a.createElement(o.a,{path:"/transform",component:R}),r.a.createElement(o.a,{path:"/indexing",component:$}),r.a.createElement(o.a,{path:"/topics",component:G})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},63:function(e,t,n){}},[[141,1,2]]]);
//# sourceMappingURL=main.b54358bf.chunk.js.map